# jsa_test_task
Тестовое JSA Group DE

AIRFLOW

Необходимо разработать даг, запускаемый ежемесячно и осуществляющий следующие
шаги:
1. Получение данных из 6ти файлов за текущий месяц
2. Формирование файла Excel с данными по всем поставкам в формате:
Склад Кол-во единиц Стоимость, руб

Параметры дага:
1. В случае неуспешного шага необходимо попробовать его выполнить 5 раз
2. В случае неуспешного шага необходимо направить информацию на email (можно
указать любой email)
3. Есть таск выполняется больше 10 секунд, необходимо направить информацию на
email (можно указать любой email)
Результат должен быть представлен в виде скрипта.

SQL

Необходимо написать функцию SQL, которая принимает 2 datetime и производит расчет
рабочего времени между ними
Рабочие дни - пн-пт
Начало рабочего дня - 9:30
Конец рабочего дня 18:30
Выходные дни по производственному календарю за 2022 - <br>
http://www.consultant.ru/law/ref/calendar/proizvodstvennye/2022/
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
### AIRFLOW DAG находится в папке airflow_dags:
1. Необходимо установить зависимости из requirements.txt
2. Необходимо добавить переменную окружения PYTHONPATH с путем до репозитория

### SQL часть с функцией находится в папке sql_date_diff_extractor файл func.sql
1. Считает только разницу между стартом и окончанием в часах, с учетом выходных и праздничных дней
2. Не реализован учет чистого рабочего времени с 9:30 до 18:30
